<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.3">
<meta name="author" content="Paras Lakhani:version: 6.0.0.BUILD-SNAPSHOT">
<title>GORM for Cassandra</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
body{margin:0}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
body{-webkit-font-smoothing:antialiased}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.no-bullet{list-style:none}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
body{tab-size:4}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menu{color:rgba(0,0,0,.8)}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css">
<style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
/*pre.CodeRay {background-color:#f7f7f8;}*/
.CodeRay .line-numbers{border-right:1px solid #d8d8d8;padding:0 0.5em 0 .25em}
.CodeRay span.line-numbers{display:inline-block;margin-right:.5em;color:rgba(0,0,0,.3)}
.CodeRay .line-numbers strong{color:rgba(0,0,0,.4)}
table.CodeRay{border-collapse:separate;border-spacing:0;margin-bottom:0;border:0;background:none}
table.CodeRay td{vertical-align: top;line-height:1.45}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.line-numbers>pre{padding:0;color:rgba(0,0,0,.3)}
table.CodeRay td.code{padding:0 0 0 .5em}
table.CodeRay td.code>pre{padding:0}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>GORM for Cassandra</h1>
<div class="details">
<span id="author" class="author">Paras Lakhani:version: 6.0.0.BUILD-SNAPSHOT</span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#introduction">Introduction</a>
<ul class="sectlevel2">
<li><a href="#compatibility">Compatibility with GORM for Hibernate</a></li>
</ul>
</li>
<li><a href="#gettingStarted">Getting Started</a>
<ul class="sectlevel2">
<li><a href="#standalone">Using GORM for Cassandra Standalone</a></li>
<li><a href="#combiningCassandraAndHibernate">Combining Cassandra and Hibernate</a></li>
<li><a href="#advancedConfig">Advanced Configuration</a></li>
<li><a href="#springBoot">Using GORM in Spring Boot</a></li>
<li><a href="#outsideGrails">GORM for Cassandra outside Grails</a></li>
</ul>
</li>
<li><a href="#mapping">Mapping to Cassandra Tables</a>
<ul class="sectlevel3">
<li><a href="#_basic_mapping">Basic Mapping</a></li>
<li><a href="#_data_types">Data types</a></li>
<li><a href="#_embedded_collections_and_maps">Embedded Collections and Maps</a></li>
<li><a href="#_customized_database_mapping">Customized Database Mapping</a></li>
<li><a href="#idGeneration">Identity Generation</a></li>
<li><a href="#compoundPrimaryKeys">Compount Primary Keys</a></li>
<li><a href="#queryIndexes">Query Indexes</a></li>
<li><a href="#tableProperties">Table Properties</a></li>
<li><a href="#stateless">Stateless Mode</a></li>
</ul>
</li>
<li><a href="#options">Querying and Persistence Options</a>
<ul class="sectlevel2">
<li><a href="#queryingOptions">Querying Options</a></li>
</ul>
</li>
<li><a href="#lowLevelApi">Cassandra Low-level API</a></li>
<li><a href="#reference">Reference</a>
<ul class="sectlevel2">
<li><a href="#ref-beans">Beans</a></li>
<li><a href="#ref-domain-classes">Domain Classes</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="introduction">Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Apache Cassandra is a massively scalable open source NoSQL database.</p>
</div>
<div class="paragraph">
<p>Cassandra can be used for managing large amounts of data across multiple data centers and the cloud.</p>
</div>
<div class="paragraph">
<p>The goal of this grails-data-mapping subproject is to provide a <em>as-complete-as-possible</em> GORM implemenatition that maps domain classes and instances to Cassandra 2.0 tables.</p>
</div>
<div class="paragraph">
<p>This project aims to provide an object-mapping layer on top of Cassandra to ease common activities such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Marshalling from Cassandra to Groovy/Java types and back again</p>
</li>
<li>
<p>Support for GORM dynamic finders, criteria and named queries</p>
</li>
<li>
<p>Session-managed transactions</p>
</li>
<li>
<p>Validating domain instances backed by the Cassandra datastore</p>
</li>
<li>
<p>Cassandra schema creation</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="compatibility">Compatibility with GORM for Hibernate</h3>
<div class="paragraph">
<p>This implementation tries to be as compatible as possible with GORM for Hibernate.
In general you can refer to the <a href="http://grails.org/doc/latest/guide/GORM.html">GORM documentation</a> and the "Domain Classes" section of the <a href="http://grails.org/doc/latest/">reference guide</a> (see the right nav) for usage information.</p>
</div>
<div class="paragraph">
<p>The following key features are supported by GORM for Cassandra:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Simple persistence methods</p>
</li>
<li>
<p>Dynamic finders</p>
</li>
<li>
<p>Criteria queries</p>
</li>
<li>
<p>Named queries</p>
</li>
<li>
<p>Inheritance</p>
</li>
<li>
<p>Embedded types</p>
</li>
<li>
<p>Query by example</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>However, some features are not supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>HQL queries</p>
</li>
<li>
<p>Associations (these should be supported in the future)</p>
</li>
<li>
<p>Any direct interaction with the Hibernate API</p>
</li>
<li>
<p>Custom Hibernate user types</p>
</li>
<li>
<p>Queries using OR, LIKE, NOT EQUAL, IS NULL, negation, property comparison, offset in paging, most projections (mainly because Cassandra itself doesn&#8217;t support these)</p>
</li>
<li>
<p>Table-per-hierarchy mapping</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There may be other limitations not mentioned here so in general it shouldn&#8217;t be expected that an application based on GORM for Hibernate will "just work" without some tweaking involved. Having said that, the large majority of common GORM functionality is supported.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="gettingStarted">Getting Started</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To get started with GORM for Cassandra you need configure it as a dependency in <code>build.gradle</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencies {
    compile <span class="string"><span class="delimiter">'</span><span class="content">org.grails.plugins:cassandra:VERSION</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that if you get exceptions during startup or execution for newer versions of Grails 3.x (3.1 and above) you may need to enforce the dependencies:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencies {
    compile <span class="string"><span class="delimiter">'</span><span class="content">org.grails.plugins:cassandra:VERSION</span><span class="delimiter">'</span></span>
    compile(<span class="string"><span class="delimiter">&quot;</span><span class="content">com.datastax.cassandra:cassandra-driver-core:2.0.4</span><span class="delimiter">&quot;</span></span>)
    compile <span class="string"><span class="delimiter">&quot;</span><span class="content">org.springframework.data:spring-data-commons:1.8.4.RELEASE</span><span class="delimiter">&quot;</span></span>
    compile(<span class="string"><span class="delimiter">&quot;</span><span class="content">org.springframework.data:spring-data-cassandra:1.0.4.RELEASE</span><span class="delimiter">&quot;</span></span>) {
        exclude <span class="key">group</span>:<span class="string"><span class="delimiter">'</span><span class="content">org.apache.cassandra</span><span class="delimiter">'</span></span>,<span class="key">module</span>:<span class="string"><span class="delimiter">'</span><span class="content">cassandra-all</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The next step is to setup a running Cassandra server.
Refer to the <a href="#ref-orgcassandra-getting-started-Apache Cassandra Getting Started Guide">Apache Cassandra Getting Started Guide</a> for an explanation on how to setup and startup a Cassandra instance.
Once installed, starting Cassandra is typically a matter of executing the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">CASSANDRA_HOME/bin/cassandra -f</code></pre>
</div>
</div>
<div class="paragraph">
<p>With the above command executed in a terminal window you should see output like the following appear:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">INFO <span class="octal">00</span>:<span class="integer">11</span>:<span class="integer">16</span>,<span class="integer">935</span> Starting listening <span class="keyword">for</span> CQL clients on localhost/<span class="float">127.0</span><span class="float">.0</span><span class="float">.1</span>:<span class="integer">9042</span>...
INFO <span class="octal">00</span>:<span class="integer">11</span>:<span class="integer">17</span>,<span class="octal">013</span> Using TFramedTransport with a max frame size of <span class="integer">15728640</span> bytes.
INFO <span class="octal">00</span>:<span class="integer">11</span>:<span class="integer">17</span>,<span class="octal">014</span> <span class="predefined-type">Binding</span> thrift service to localhost/<span class="float">127.0</span><span class="float">.0</span><span class="float">.1</span>:<span class="integer">9160</span>
INFO <span class="octal">00</span>:<span class="integer">11</span>:<span class="integer">17</span>,<span class="octal">042</span> Using synchronous/threadpool thrift server on localhost : <span class="integer">9160</span>
INFO <span class="octal">00</span>:<span class="integer">11</span>:<span class="integer">17</span>,<span class="octal">042</span> Listening <span class="keyword">for</span> thrift clients...</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see the server listens for CQL clients on port 9042, but don&#8217;t worry the Cassandra plugin for Grails will automatically configure itself to look for Cassandra on that port by default.</p>
</div>
<div class="paragraph">
<p>If you want to configure how Grails connects to Cassandra then you can do so using the following settings in <code>grails-app/conf/application.yml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="key">grails</span>:
    <span class="key">cassandra</span>:
        <span class="key">contactPoints</span>: localhost
        <span class="key">port</span>: <span class="integer">9042</span>
        <span class="key">keyspace</span>:
            <span class="key">name</span>: foo
    }
}</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="standalone">Using GORM for Cassandra Standalone</h3>
<div class="paragraph">
<p>If you plan to use Cassandra as your primary datastore then you need to remove the Hibernate plugin from your <code>build.gradle</code> file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">compile <span class="string"><span class="delimiter">'</span><span class="content">org.grails.plugins:hibernate</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>With this done all domain classes in grails-app/domain will be persisted via Cassandra and not Hibernate. You can create a domain class by running the regular <code>create-domain-class</code> command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">grails create-domain-<span class="type">class</span> <span class="class">Person</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>Person</code> domain class will automatically be a persistent entity that can be stored in Cassandra. Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Person</span> {
    <span class="predefined-type">String</span> firstName
    <span class="predefined-type">String</span> lastName
}
<span class="keyword">def</span> person = <span class="keyword">new</span> Person(<span class="key">firstName</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Fred</span><span class="delimiter">&quot;</span></span>, <span class="key">lastName</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Flintstone</span><span class="delimiter">&quot;</span></span>)

person.save()
...
def person2 = Person.get(uuid)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="combiningCassandraAndHibernate">Combining Cassandra and Hibernate</h3>
<div class="paragraph">
<p>If you have both the Hibernate and Cassandra plugins installed then by default all classes in the <code>grails-app/domain</code> directory will be persisted by Hibernate and not Cassandra.
If you want to persist a particular domain class with Cassandra then you must use the <code>mapWith</code> property in the domain class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="directive">static</span> mapWith = <span class="string"><span class="delimiter">&quot;</span><span class="content">cassandra</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>By default the Hibernate plugin transparently adds an implicit <code>id</code> property of type <code>Long</code> to your domain class. The Cassandra plugin adds an <code>id</code> property of type <code>UUID</code>.
If you install both plugins, the <code>id</code> property will be of type <code>Long</code>.
So if you have a domain class with an auto-generated <code>id</code> (the default behaviour) and you want to save it to both datastores, you should define a <code>UUID id</code>
property as a <code>Long</code> won&#8217;t really work for Cassandra. You also need to set the id&#8217;s <code>generator</code> attribute so that the Hibernate plugin can auto-generate a <code>UUID</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="advancedConfig">Advanced Configuration</h3>
<div class="sect3">
<h4 id="_cassandra_database_connection_configuration">Cassandra Database Connection Configuration</h4>
<div class="paragraph">
<p>As mentioned above, the GORM for Cassandra plugin will configure itself with default settings, but if you wish to customize those defaults you can do so in the <code>grails-app/conf/application.groovy</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">grails {
    cassandra {
        contactPoints = <span class="string"><span class="delimiter">&quot;</span><span class="content">localhost</span><span class="delimiter">&quot;</span></span>
        port = <span class="integer">9042</span>
        schemaAction = <span class="string"><span class="delimiter">&quot;</span><span class="content">recreate-drop-unused</span><span class="delimiter">&quot;</span></span>
        keyspace {
            name = <span class="string"><span class="delimiter">&quot;</span><span class="content">foo</span><span class="delimiter">&quot;</span></span>
            action = <span class="string"><span class="delimiter">&quot;</span><span class="content">create</span><span class="delimiter">&quot;</span></span>
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>keyspace name</code> property configures the default keyspace to use. If it&#8217;s not specified the <code>keyspace</code> used will default to the name of your application.</p>
</div>
<div class="paragraph">
<p>In production scenarios you will typically use more than one Cassandra node:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">grails {
    cassandra {
        contactPoints = <span class="string"><span class="delimiter">&quot;</span><span class="content">192.168.0.1, 192.168.0.2</span><span class="delimiter">&quot;</span></span> <span class="comment">//comma-separated list of hostnames or IP addresses of nodes to connect to</span>
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_keyspace_creation">Keyspace creation</h4>
<div class="paragraph">
<p>If you want the plugin to automatically create the application&#8217;s keyspace you can specify a value for the <code>keyspace action</code> property:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">grails {
    cassandra {
        keyspace {
            name = <span class="string"><span class="delimiter">&quot;</span><span class="content">foo</span><span class="delimiter">&quot;</span></span>
            action = <span class="string"><span class="delimiter">&quot;</span><span class="content">create</span><span class="delimiter">&quot;</span></span>
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Valid options for <code>action</code> are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>create</strong> - Create the keyspace if it doesn&#8217;t exist</p>
</li>
<li>
<p><strong>create-drop</strong> - Drop the keyspace and create it if doesn&#8217;t exist</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_schema_creation">Schema creation</h4>
<div class="paragraph">
<p>The plugin can automatically create the Cassandra tables and indexes required for your domain model. You have some control over when and how it does this through the <code>dbCreate</code> property, which can take these values:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>none</strong> - The default. Do not create any schema objects.</p>
</li>
<li>
<p><strong>create</strong> - Create a table and indexes for each domain class on startup. Fail if a table already exists.</p>
</li>
<li>
<p><strong>recreate</strong> - Create a table and indexes for each domain class on startup, dropping the table first if it exists.</p>
</li>
<li>
<p><strong>recreate-drop-unused</strong> - Drop <strong>all</strong> tables in the keyspace, then create a table and indexes for each domain class on startup.</p>
</li>
<li>
<p>update - TO IMPLEMENT</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">grails {
    cassandra {
        dbCreate = <span class="string"><span class="delimiter">&quot;</span><span class="content">recreate-drop-unused</span><span class="delimiter">&quot;</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can remove the dbCreate property completely, which is recommended once your schema is relatively stable and definitely when your application and database are deployed in production.</p>
</div>
</div>
<div class="sect3">
<h4 id="_configuration_options_guide">Configuration Options Guide</h4>
<div class="paragraph">
<p>Below is a complete example showing all configuration options, including <a href="http://www.datastax.com/documentation/cql/3.1/cql/cql_reference/create_keyspace_r.html">keyspace options</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">grails {
    cassandra {
            contactPoints = <span class="string"><span class="delimiter">&quot;</span><span class="content">localhost</span><span class="delimiter">&quot;</span></span> <span class="comment">//comma-separated list of hostnames or IP addresses of nodes to connect to</span>
        port = <span class="integer">9042</span> <span class="comment">//the port to connect to</span>
        dbCreate = <span class="string"><span class="delimiter">&quot;</span><span class="content">recreate</span><span class="delimiter">&quot;</span></span> <span class="comment">//the strategy to create cassandra tables and indexes for domain classes, default: &quot;none&quot;</span>
        stateless = <span class="predefined-constant">false</span> <span class="comment">// whether to use stateless sessions by default</span>

        keyspace {
            name = <span class="string"><span class="delimiter">&quot;</span><span class="content">foo</span><span class="delimiter">&quot;</span></span> <span class="comment">//the name of the keyspace to use, default: the name of the application</span>
            action = <span class="string"><span class="delimiter">&quot;</span><span class="content">create</span><span class="delimiter">&quot;</span></span> <span class="comment">//whether to create a keyspace, default: no keyspace created</span>

            <span class="comment">//keyspace properties to set only if the plugin is to create the keyspace</span>
            durableWrites = <span class="predefined-constant">false</span> <span class="comment">//default: false</span>
            replicationStrategy = <span class="string"><span class="delimiter">&quot;</span><span class="content">SIMPLE_STRATEGY</span><span class="delimiter">&quot;</span></span> OR <span class="string"><span class="delimiter">&quot;</span><span class="content">NETWORK_TOPOLOGY_STRATEGY</span><span class="delimiter">&quot;</span></span> <span class="comment">//default: &quot;SIMPLE_STRATEGY&quot;</span>
            replicationFactor = <span class="integer">1</span> <span class="comment">//default: 1</span>
            dataCenter = [<span class="integer">1</span>,[us-west] <span class="integer">2</span>][eu-west] <span class="comment">//if replicationStrategy is &quot;NetworkTopologyStrategy&quot;,</span>
                                                    <span class="comment">//a map of data centre names and replication factors</span>
        }
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_global_mapping_configuration">Global Mapping Configuration</h4>
<div class="paragraph">
<p>Using the <code>grails.cassandra.default.mapping</code> setting in <code>application.groovy</code> you can configure global mapping options across your domain classes.
The following configuration will disable optimistic locking globally:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">grails.cassandra.default.mapping = {
    version <span class="predefined-constant">false</span>
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="springBoot">Using GORM in Spring Boot</h3>
<div class="paragraph">
<p>To use GORM for Hibernate in Spring Boot add the necessary dependencies to your Boot application:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">compile(<span class="string"><span class="delimiter">&quot;</span><span class="content">org.grails:gorm-cassandra-spring-boot:VERSION</span><span class="delimiter">&quot;</span></span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that if you get exceptions during startup or execution for newer versions of Spring Boot  (1.3 and above) you may need to enforce the dependencies:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencies {
    compile(<span class="string"><span class="delimiter">&quot;</span><span class="content">org.grails:gorm-cassandra-spring-boot:VERSION</span><span class="delimiter">&quot;</span></span>)
    compile(<span class="string"><span class="delimiter">&quot;</span><span class="content">com.datastax.cassandra:cassandra-driver-core:2.0.4</span><span class="delimiter">&quot;</span></span>)
    compile <span class="string"><span class="delimiter">&quot;</span><span class="content">org.springframework.data:spring-data-commons:1.8.4.RELEASE</span><span class="delimiter">&quot;</span></span>
    compile(<span class="string"><span class="delimiter">&quot;</span><span class="content">org.springframework.data:spring-data-cassandra:1.0.4.RELEASE</span><span class="delimiter">&quot;</span></span>) {
        exclude <span class="key">group</span>:<span class="string"><span class="delimiter">'</span><span class="content">org.apache.cassandra</span><span class="delimiter">'</span></span>,<span class="key">module</span>:<span class="string"><span class="delimiter">'</span><span class="content">cassandra-all</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ensure your Boot <code>Application</code> class is annotated with <code>ComponentScan</code>, example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">org.springframework.boot.SpringApplication</span>
<span class="keyword">import</span> <span class="include">org.springframework.boot.autoconfigure.EnableAutoConfiguration</span>
<span class="keyword">import</span> <span class="include">org.springframework.context.annotation.*</span>

<span class="annotation">@Configuration</span>
<span class="annotation">@EnableAutoConfiguration</span>
<span class="annotation">@ComponentScan</span>
<span class="type">class</span> <span class="class">Application</span> {
    <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        SpringApplication.run Application, args
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Using <code>ComponentScan</code> without a value results in Boot scanning for classes in the same package or any package nested within the <code>Application</code> class package.
If your GORM entities are in a different package specify the package name as the value of the <code>ComponentScan</code> annotation.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Finally create your GORM entities and ensure they are annotated with <code>grails.persistence.Entity</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">grails.persistence.*</span>

<span class="annotation">@Entity</span>
<span class="type">class</span> <span class="class">Person</span> {
    <span class="predefined-type">String</span> firstName
    <span class="predefined-type">String</span> lastName
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="outsideGrails">GORM for Cassandra outside Grails</h3>
<div class="paragraph">
<p>If you wish to use GORM for Cassandra outside of a Grails application you should declare the necessary dependencies, for example in Gradle:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">compile <span class="string"><span class="delimiter">&quot;</span><span class="content">org.grails:grails-datastore-gorm-cassandra:VERSION</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Then annotate your entities with the <code>grails.gorm.annotation.Entity</code> annotation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="annotation">@Entity</span>
<span class="type">class</span> <span class="class">Person</span> {
    <span class="predefined-type">String</span> name
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then you need to place the bootstrap logic somewhere in your application which uses <code>CassandraDatastoreSpringInitializer</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> initializer = <span class="keyword">new</span> CassandraDatastoreSpringInitializer(Person)
<span class="keyword">def</span> applicationContext = initializer.configure()

println Person.count()</code></pre>
</div>
</div>
<div class="paragraph">
<p>For configuration you can either pass a map or an instance of the <code>org.springframework.core.env.PropertyResolver</code> interface:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> initializer = <span class="keyword">new</span> CassandraDatastoreSpringInitializer([<span class="string"><span class="delimiter">'</span><span class="content">grails.cassandra.port</span><span class="delimiter">'</span></span>:<span class="integer">7891</span>], Person)
<span class="keyword">def</span> applicationContext = initializer.configure()

println Person.count()</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you are using Spring with an existing <code>ApplicationContext</code> you can instead call <code>configureForBeanDefinitionRegistry</code> prior to refreshing the context. You can pass the Spring <code>Environment</code> object to the constructor for configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">ApplicationContext myApplicationContext = ...
def initializer = <span class="keyword">new</span> CassandraDatastoreSpringInitializer(myApplicationContext.getEnvironment(), Person)
initializer.configureForBeanDefinitionRegistry(myApplicationContext)

println Person.count()</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="mapping">Mapping to Cassandra Tables</h2>
<div class="sectionbody">
<div class="sect3">
<h4 id="_basic_mapping">Basic Mapping</h4>
<div class="paragraph">
<p>The way the GORM for Cassandra plugin works is to map each domain class to a Cassandra table. For example given a domain class such as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Person</span> {
    <span class="predefined-type">String</span> firstName
    <span class="predefined-type">String</span> lastName
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will map onto a Cassandra table called "person" and generate the following table if schema creation is on:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">CREATE TABLE person (id uuid, firstname text, lastname text, version bigint, PRIMARY KEY (id));</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The plugin transparently adds an implicit <code>id</code> property of type UUID which is auto-generated when an entity is saved.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_data_types">Data types</h4>
<div class="paragraph">
<p>In general a property&#8217;s Java type maps onto a CQL3 data type as listed <a href="http://www.datastax.com/documentation/developer/java-driver/2.0/java-driver/reference/javaClass2Cql3Datatypes_r.html">here</a>
Some Java types can map onto more than one CQL3 data type, the default mappings are shown in bold:
* <code>java.util.UUID</code> - CQL <strong>uuid</strong> or <code>timeuuid</code>
* <code>java.lang.String</code> - CQL <strong>text</strong> or <code>ascii</code> or <code>varchar</code>
* <code>long</code> / <code>java.lang.Long</code> - CQL <strong>bigint</strong> or <code>counter</code></p>
</div>
<div class="paragraph">
<p>Java <code>byte</code> and <code>short</code> map onto CQL <code>int</code>.</p>
</div>
<div class="paragraph">
<p>To map onto a different CQL type specify the <code>type</code> attribute in the mapping. Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Person</span> {
    <span class="predefined-type">String</span> firstName
    <span class="predefined-type">String</span> lastName
    <span class="predefined-type">UUID</span> timeuuid
    <span class="predefined-type">String</span> ascii
    <span class="predefined-type">String</span> varchar
    <span class="type">long</span> counter

    <span class="directive">static</span> mapping = {
        timeuuid <span class="key">type</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">timeuuid</span><span class="delimiter">&quot;</span></span>
        ascii <span class="key">type</span>:<span class="string"><span class="delimiter">'</span><span class="content">ascii</span><span class="delimiter">'</span></span>
        varchar <span class="key">type</span>:<span class="string"><span class="delimiter">'</span><span class="content">varchar</span><span class="delimiter">'</span></span>
        counter <span class="key">type</span>:<span class="string"><span class="delimiter">'</span><span class="content">counter</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_embedded_collections_and_maps">Embedded Collections and Maps</h4>
<div class="paragraph">
<p>You can map embedded lists, sets and maps of standard CQL data types simply by defining the appropriate collection type:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Person</span> {
    <span class="predefined-type">String</span> firstName
    <span class="predefined-type">String</span> lastName
    <span class="predefined-type">List</span>&lt;<span class="predefined-type">Integer</span>&gt; scores
    <span class="predefined-type">Set</span>&lt;<span class="predefined-type">String</span>&gt; friends
    <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; pets
}

...

new Person(<span class="key">friends</span>:[<span class="string"><span class="delimiter">'</span><span class="content">Fred</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">Bob</span><span class="delimiter">'</span></span>], <span class="key">pets</span>:[<span class="key">chuck</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">Dog</span><span class="delimiter">&quot;</span></span>, <span class="key">eddie</span>:<span class="string"><span class="delimiter">'</span><span class="content">Parrot</span><span class="delimiter">'</span></span>]).save()</code></pre>
</div>
</div>
<div class="paragraph">
<p>There are certain <a href="http://www.datastax.com/documentation/cql/3.1/cql/cql_using/use_collections_c.html">limitations</a> on collections and only the standard CQL data types can be stored inside embedded collections and maps.</p>
</div>
<div class="paragraph">
<p>When persisting a domain class containing embedded collections or maps using the <code>save</code> method, the entire collection or map is saved or updated to Cassandra.
This may not be appropriate if you only want to persist the non-collection properties, in which case you can use the <code>updateSimpleTypes</code> instance method.
Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> person = Person.get(uuid)
person.age = <span class="integer">31</span>
person.updateSimpleTypes(<span class="key">flush</span>:<span class="predefined-constant">true</span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you want to add or remove an item from a collection or map and only have that change updated to Cassandra you can use the various dynamic methods listed in the "Domain Classes" section of the right nav.
Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">person.prependToScores(<span class="integer">5</span>)
Person.appendToFriends(person.id, <span class="string"><span class="delimiter">'</span><span class="content">Barney</span><span class="delimiter">'</span></span>)
Person.deleteFromPets(person.id, <span class="string"><span class="delimiter">'</span><span class="content">eddie</span><span class="delimiter">'</span></span>, [<span class="key">flush</span>:<span class="predefined-constant">true</span>])</code></pre>
</div>
</div>
<div class="paragraph">
<p>The last <code>flush:true</code> argument causes the session to flush the pending collection updates to the datastore.</p>
</div>
</div>
<div class="sect3">
<h4 id="_customized_database_mapping">Customized Database Mapping</h4>
<div class="paragraph">
<p>You may wish to customize how a domain class maps onto a Cassandra table. This is possible using the <code>mapping</code> block as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Person</span> {
    ..
    <span class="directive">static</span> mapping = {
        table <span class="string"><span class="delimiter">&quot;</span><span class="content">the_person</span><span class="delimiter">&quot;</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example we see that the <code>Person</code> entity has been mapped to a table called "the_person".</p>
</div>
<div class="paragraph">
<p>You can also control how an individual property maps onto a table column (the default is to use the property name itself):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Person</span> {
    ..
    <span class="directive">static</span> mapping = {
        firstName <span class="key">column</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">first_name</span><span class="delimiter">&quot;</span></span>
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="idGeneration">Identity Generation</h3>
<div class="paragraph">
<p>By default in Cassandra GORM domain classes are supplied with a UUID-based identifier. So for example the following entity:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Person</span> {}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Has a property called <code>id</code> of type <code>java.util.UUID</code>. In this case GORM for Cassandra will generate a UUID identifier using java.util.UUID.randomUUID().
For a <code>timeuuid</code> it will generate one using the <a href="http://www.datastax.com/drivers/java/2.0/com/datastax/driver/core/utils/UUIDs.html#timeBased%28%29">Java driver</a></p>
</div>
<div class="paragraph">
<p>You can name the <code>id</code> property something else, in which case you have to set the <code>name</code> attribute in the mapping:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Person</span> {
    <span class="predefined-type">UUID</span> primary

    <span class="directive">static</span> mapping = {
            id <span class="key">name</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">primary</span><span class="delimiter">&quot;</span></span>
    }
}</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_assigned_identifiers">Assigned Identifiers</h4>
<div class="paragraph">
<p>If you want to manually assign an identifier, the following mapping should be used:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Person</span> {
    <span class="predefined-type">String</span> firstName
    <span class="predefined-type">String</span> lastName

    <span class="directive">static</span> mapping = {
        id <span class="key">name</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">lastName</span><span class="delimiter">&quot;</span></span>, <span class="key">generator</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">assigned</span><span class="delimiter">&quot;</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that it is important to specify generator:"assigned" so GORM can work out whether you are trying to achieve an insert or an update.
Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> p = <span class="keyword">new</span> Person(<span class="key">lastName</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">Wilson</span><span class="delimiter">&quot;</span></span>)
<span class="comment">// to insert</span>
p.save()
<span class="comment">// to update</span>
p.save()</code></pre>
</div>
</div>
<div class="paragraph">
<p>An existing manually-assigned entity will only be updated with the <code>save</code> method if it is in the current persistence session.
Otherwise GORM will try to insert the entity again, which will result in an upsert to Cassandra (with no version checking if versioning is on).
So if the entity is not in the session and you want to explicitly direct an update to Cassandra then use the <code>update</code> method instead of the <code>save</code> method.
Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> p = <span class="keyword">new</span> Person(<span class="key">lastName</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">Wilson</span><span class="delimiter">&quot;</span></span>)
<span class="comment">// to insert</span>
p.save()
session.clear() or p.discard()
<span class="comment">// to update</span>
p.update()</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="compoundPrimaryKeys">Compount Primary Keys</h3>
<div class="paragraph">
<p>In Cassandra, a compound primary key consists of more than one column and treats only one column as the partition key. The other columns are treated as clustering columns.
To define a compound primary key on a domain class, each property that is part of the key has to be defined in the mapping block with a <code>primaryKey</code> map. Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Person</span>  {

    <span class="predefined-type">String</span> lastName
    <span class="predefined-type">String</span> firstName
    <span class="predefined-type">Integer</span> age = <span class="integer">0</span>
    <span class="predefined-type">String</span> location

    <span class="directive">static</span> mapping = {
        id <span class="key">name</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">lastName</span><span class="delimiter">&quot;</span></span>, <span class="key">primaryKey</span>:[<span class="key">ordinal</span>:<span class="integer">0</span>, <span class="key">type</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">partitioned</span><span class="delimiter">&quot;</span></span>], <span class="key">generator</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">assigned</span><span class="delimiter">&quot;</span></span>
        firstName <span class="key">index</span>:<span class="predefined-constant">true</span>, <span class="key">primaryKey</span>:[<span class="key">ordinal</span>:<span class="integer">1</span>, <span class="key">type</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">clustered</span><span class="delimiter">&quot;</span></span>]
        age <span class="key">primaryKey</span>:[<span class="key">ordinal</span>:<span class="integer">2</span>, <span class="key">type</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">clustered</span><span class="delimiter">&quot;</span></span>]
        version <span class="predefined-constant">false</span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The above mapping will generate the following Cassandra table if schema creation is on:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">CREATE TABLE person (lastname text, firstname text, age <span class="type">int</span>, location text, PRIMARY KEY (lastname, firstname, age))</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_composite_partition_key">Composite Partition Key</h4>
<div class="paragraph">
<p>A composite partition key consists of multiple columns and treats more than one column as the partition key. The other columns are treated as clustering columns.
To define a composite partition key on a domain class, each property that is a part of the key has to have its <code>primaryKey type</code> attribute set to "partitioned". Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Person</span>  {

    <span class="predefined-type">String</span> lastName
    <span class="predefined-type">String</span> firstName
    <span class="predefined-type">Integer</span> age = <span class="integer">0</span>
    <span class="predefined-type">String</span> location

    <span class="directive">static</span> mapping = {
        id <span class="key">name</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">lastName</span><span class="delimiter">&quot;</span></span>, <span class="key">primaryKey</span>:[<span class="key">ordinal</span>:<span class="integer">0</span>, <span class="key">type</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">partitioned</span><span class="delimiter">&quot;</span></span>], <span class="key">generator</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">assigned</span><span class="delimiter">&quot;</span></span>
        firstName <span class="key">index</span>:<span class="predefined-constant">true</span>, <span class="key">primaryKey</span>:[<span class="key">ordinal</span>:<span class="integer">1</span>, <span class="key">type</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">partitioned</span><span class="delimiter">&quot;</span></span>]
        age <span class="key">index</span>:<span class="predefined-constant">true</span>, <span class="key">primaryKey</span>:[<span class="key">ordinal</span>:<span class="integer">0</span>, <span class="key">type</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">clustered</span><span class="delimiter">&quot;</span></span>]
        version <span class="predefined-constant">false</span>
    }
}
...
CREATE TABLE person (lastname text, firstname text, age <span class="type">int</span>, location text, PRIMARY KEY ((lastname, firstname), age))</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_the_mapping_block">The mapping block</h4>
<div class="paragraph">
<p>The first column of the partition key is always mapped using <code>id</code>, and then the name of the actual property.</p>
</div>
<div class="paragraph">
<p>You should then add the <code>primaryKey</code> map to all columns of the compound/composite primary key. The two attributes are:
* <code>ordinal</code> - specifies the order of the column in the compound/composite primary key.
* <code>type</code> - "partitioned" or "clustered". For a compound primary key only one property is type "partitioned" and the rest are type "clustered". For a composite partition key more than one property is type "partitioned".</p>
</div>
</div>
<div class="sect3">
<h4 id="_persistence_and_querying_for_compound_composite_primary_key_domain_classes">Persistence and Querying for Compound/Composite Primary Key domain classes</h4>
<div class="paragraph">
<p>Where you need to pass in an id to a persistence or query method, use a map containing the components of the compound/composite primary key instead.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> person = Person.get([<span class="key">firstName</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">Bob</span><span class="delimiter">&quot;</span></span>, <span class="key">lastName</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Wilson</span><span class="delimiter">&quot;</span></span>, <span class="key">age</span>: <span class="integer">25</span>])
Person.updateProperties([<span class="key">firstName</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">Bob</span><span class="delimiter">&quot;</span></span>, <span class="key">lastName</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Wilson</span><span class="delimiter">&quot;</span></span>, <span class="key">age</span>: <span class="integer">25</span>], [<span class="key">location</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">London</span><span class="delimiter">&quot;</span></span>], [<span class="key">flush</span>:<span class="predefined-constant">true</span>])</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="queryIndexes">Query Indexes</h3>
<div class="sect3">
<h4 id="_basics">Basics</h4>
<div class="paragraph">
<p>Cassandra doesn&#8217;t require that you specify indices to query. Cassandra supports creating an index on most columns, including a clustering column of a compound primary key or on the partition (primary) key itself.
Indexing can impact performance greatly. Before creating an index, be aware of when and <a href="http://www.datastax.com/documentation/cql/3.1/cql/ddl/ddl_when_use_index_c.html#concept_ds_sgh_yzz_zj__when-no-index">when not to create an index</a>.</p>
</div>
<div class="paragraph">
<p>With that in mind it is important to specify the properties you plan to query using the mapping block:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Person</span> {
    <span class="predefined-type">String</span> name
    <span class="directive">static</span> mapping = {
        name <span class="key">index</span>:<span class="predefined-constant">true</span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The above mapping will generate the following Cassandra index if schema creation is on:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">CREATE INDEX IF NOT EXISTS  ON person (name)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="tableProperties">Table Properties</h3>
<div class="paragraph">
<p>You can configure clustering order, caching, compaction, and a number of other operations that Cassandra performs on a new table.</p>
</div>
<div class="sect3">
<h4 id="_clustering_order">Clustering order</h4>
<div class="paragraph">
<p>An explanation is provided in the <a href="http://www.datastax.com/documentation/cql/3.1/cql/cql_reference/refClstrOrdr.html">Cassandra docs</a>.
Clustering order can only be used on a clustered primary key, to use it set its order attribute. Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Person</span> {
    ..
    <span class="directive">static</span> mapping = {
        id <span class="key">name</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">lastName</span><span class="delimiter">&quot;</span></span>, <span class="key">primaryKey</span>:[<span class="key">ordinal</span>:<span class="integer">0</span>, <span class="key">type</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">partitioned</span><span class="delimiter">&quot;</span></span>], <span class="key">generator</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">assigned</span><span class="delimiter">&quot;</span></span>
        firstName <span class="key">index</span>:<span class="predefined-constant">true</span>, <span class="key">primaryKey</span>:[<span class="key">ordinal</span>:<span class="integer">1</span>, <span class="key">type</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">clustered</span><span class="delimiter">&quot;</span></span>], <span class="key">order</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">desc</span><span class="delimiter">&quot;</span></span> <span class="comment">//or order: &quot;asc&quot;</span>
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_setting_a_table_property">Setting a table property</h4>
<div class="paragraph">
<p>Available properties and their descriptions are defined in the <a href="http://www.datastax.com/documentation/cql/3.1/cql/cql_reference/tabProp.html">Cassandra docs</a>.
If you want to set a table property, define a static <code>tableProperties</code> block.
Below is an example of the properties you can set with Cassandra GORM:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Person</span> {
    ..
    <span class="directive">static</span> mapping = {
        id <span class="key">name</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">lastName</span><span class="delimiter">&quot;</span></span>, <span class="key">primaryKey</span>:[<span class="key">ordinal</span>:<span class="integer">0</span>, <span class="key">type</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">partitioned</span><span class="delimiter">&quot;</span></span>]
        firstName <span class="key">primaryKey</span>:[<span class="key">ordinal</span>:<span class="integer">1</span>, <span class="key">type</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">clustered</span><span class="delimiter">&quot;</span></span>], <span class="key">order</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">desc</span><span class="delimiter">&quot;</span></span>
    }

    <span class="directive">static</span> tableProperties = {
        comment <span class="string"><span class="delimiter">&quot;</span><span class="content">table comment</span><span class="delimiter">&quot;</span></span>
        <span class="string"><span class="delimiter">&quot;</span><span class="content">COMPACT STORAGE</span><span class="delimiter">&quot;</span></span> <span class="predefined-constant">true</span> <span class="comment">//OR &quot;compact_storage&quot; true</span>
        replicate_on_write <span class="predefined-constant">false</span>
        caching <span class="string"><span class="delimiter">&quot;</span><span class="content">all</span><span class="delimiter">&quot;</span></span>
        bloom_filter_fp_chance <span class="float">0.2</span>
        read_repair_chance <span class="float">0.1</span>
        dclocal_read_repair_chance <span class="float">0.2</span>
        gc_grace_seconds <span class="integer">900000</span>
        compaction <span class="type">class</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">SizeTieredCompactionStrategy</span><span class="delimiter">&quot;</span></span>, <span class="class">bucket_high</span>: <span class="float">2.5</span>, <span class="key">bucket_low</span>: <span class="float">0.6</span>, <span class="key">max_threshold</span>: <span class="integer">40</span>, <span class="key">min_threshold</span>: <span class="integer">5</span>, <span class="key">min_sstable_size</span>: <span class="integer">60</span>
        compression <span class="key">sstable_compression</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">LZ4Compressor</span><span class="delimiter">&quot;</span></span>, <span class="key">chunk_length_kb</span>: <span class="integer">128</span>,        <span class="key">crc_check_chance</span>: <span class="float">0.85</span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The above mapping will generate the following Cassandra table if schema creation is on:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">CREATE TABLE person (lastname text, firstname text, version bigint, PRIMARY KEY (lastname, firstname))
WITH CLUSTERING ORDER BY (firstname DESC) AND comment = <span class="string"><span class="delimiter">'</span><span class="content">table comment</span><span class="delimiter">'</span></span> AND COMPACT STORAGE AND replicate_on_write = <span class="string"><span class="delimiter">'</span><span class="content">false</span><span class="delimiter">'</span></span>
AND caching = <span class="string"><span class="delimiter">'</span><span class="content">all</span><span class="delimiter">'</span></span> AND bloom_filter_fp_chance = <span class="float">0.2</span> AND read_repair_chance = <span class="float">0.1</span> AND dclocal_read_repair_chance = <span class="float">0.2</span>
AND gc_grace_seconds = <span class="integer">900000</span>
AND compaction = { <span class="string"><span class="delimiter">'</span><span class="content">class</span><span class="delimiter">'</span></span> : <span class="string"><span class="delimiter">'</span><span class="content">SizeTieredCompactionStrategy</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">bucket_high</span><span class="delimiter">'</span></span> : <span class="float">2.5</span>, <span class="string"><span class="delimiter">'</span><span class="content">bucket_low</span><span class="delimiter">'</span></span> : <span class="float">0.6</span>, <span class="string"><span class="delimiter">'</span><span class="content">max_threshold</span><span class="delimiter">'</span></span> : <span class="integer">40</span>, <span class="string"><span class="delimiter">'</span><span class="content">min_threshold</span><span class="delimiter">'</span></span> : <span class="integer">5</span>,
                   <span class="string"><span class="delimiter">'</span><span class="content">min_sstable_size</span><span class="delimiter">'</span></span> : <span class="integer">60</span> }
AND compression = { <span class="string"><span class="delimiter">'</span><span class="content">sstable_compression</span><span class="delimiter">'</span></span> : <span class="string"><span class="delimiter">'</span><span class="content">LZ4Compressor</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">chunk_length_kb</span><span class="delimiter">'</span></span> : <span class="integer">128</span>, <span class="string"><span class="delimiter">'</span><span class="content">crc_check_chance</span><span class="delimiter">'</span></span> : <span class="float">0.85</span> };</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="__a_href_http_www_datastax_com_documentation_cql_3_1_cql_cql_reference_tabprop_html_table_property_options_a"><a href="http://www.datastax.com/documentation/cql/3.1/cql/cql_reference/tabProp.html">Table property options</a></h4>
<div class="ulist">
<ul>
<li>
<p>comment : String</p>
</li>
<li>
<p>"COMPACT STORAGE" OR "compact_storage" : boolean</p>
</li>
<li>
<p>replicate_on_write : boolean</p>
</li>
<li>
<p>caching : "all", "keys_only", "rows_only", "none"</p>
</li>
<li>
<p>bloom_filter_fp_chance : double</p>
</li>
<li>
<p>read_repair_chance : double</p>
</li>
<li>
<p>dclocal_read_repair_chance : double</p>
</li>
<li>
<p>gc_grace_seconds : long</p>
</li>
<li>
<p>compaction : [class, tombstone_threshold, tombstone_compaction_interval, min_sstable_size, min_threshold, max_threshold, bucket_low, bucket_high, sstable_size_in_mb]</p>
</li>
<li>
<p>compression : [sstable_compression, chunk_length_kb, crc_check_chance]</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="stateless">Stateless Mode</h3>
<div class="paragraph">
<p>GORM for Cassandra supports both stateless and stateful modes for mapping domain classes to Cassandra. In general stateful mapping is superior for write heavy applications and stateless mode better for read heavy applications (particularily when large amounts of data is involved).</p>
</div>
<div class="sect3">
<h4 id="_stateful_mode">Stateful mode</h4>
<div class="paragraph">
<p>Domain classes are by default stateful, which means when they are read from Cassandra their state is stored in the user session (which is typically bound to the request in Grails). This has several advantages for write heavy applications:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>GORM can automatically detect whether a call to save() is a an update or an insert and act appropriately</p>
</li>
<li>
<p>GORM can store the current version and therefore implement optimistic locking</p>
</li>
<li>
<p>Repeated reads of the same entity can be retrieved from the cache, thus optimizing reads as well</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>An example of when a stateful domain class is better is batching (TO BE IMPLEMENTED)</p>
</div>
</div>
<div class="sect3">
<h4 id="_stateless_domain_classes">Stateless Domain classes</h4>
<div class="paragraph">
<p>However, stateful domain classes can cause problems for read-heavy applications. Take for example the following code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> books = <span class="predefined-type">Book</span>.list() <span class="comment">// read 100,000 books</span>
<span class="keyword">for</span>(b <span class="keyword">in</span> books) {
    println b.title
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The above example will read 100,000 books and print the title of each. In stateful mode this will almost certainly run out of memory as each Cassandra row is stored in user memory as is each book. Rewriting the code as follows will solve the problem:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="predefined-type">Book</span>.withStatelessSession {
    <span class="keyword">def</span> books = <span class="predefined-type">Book</span>.list() <span class="comment">// read 100,000 books</span>
    <span class="keyword">for</span>(b <span class="keyword">in</span> books) {
        println b.title
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively you can map the domain class as stateless, in which case its state will never be stored in the session:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Book</span> {
    ...
    static mapping = {
        stateless <span class="predefined-constant">true</span>
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_disadvantages_of_stateless_mode">Disadvantages of Stateless Mode</h4>
<div class="paragraph">
<p>There are several disadvantages to using stateless domain classes as the default. One disadvantage is that if you are using assigned identifiers GORM cannot detect whether you want to do an insert or an update so you have to be explicit about which one you want:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> b = <span class="keyword">new</span> <span class="predefined-type">Book</span>(<span class="key">id</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">The Book</span><span class="delimiter">&quot;</span></span>)
b.insert()
b.revenue = <span class="integer">100</span>
b.update()</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above case we use the explicit <em>insert</em> or 'update method to tell Cassandra GORM what to do.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="options">Querying and Persistence Options</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The GORM for Cassandra plugin supports passing various options to Cassandra when querying or persisting.</p>
</div>
<div class="sect2">
<h3 id="queryingOptions">Querying Options</h3>
<div class="sect3">
<h4 id="_limiting_results">Limiting results</h4>
<div class="paragraph">
<p>Using the <code>max</code> parameter, you can specify that the query return a limited number of rows. Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> people = Person.list(<span class="key">max</span>:<span class="integer">2</span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that Cassandra does not support the <code>offset</code> parameter, so you cannot page results this way.</p>
</div>
</div>
<div class="sect3">
<h4 id="_fetch_size">Fetch Size</h4>
<div class="paragraph">
<p>Setting the <a href="http://www.datastax.com/documentation/developer/java-driver/2.0/java-driver/reference/queryBuilderOverview.html?scroll=queryBuilderOverview__setting-query-options-querybuilder-api">fetch size</a>, or number of rows returned simultaneously by a select query, is typically needed when queries return extremely large numbers of rows.
To do this you can use the <code>fetchSize</code> argument:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> people = Person.list([<span class="key">fetchSize</span>: <span class="integer">200</span>])
people = Person.findAllByFirstName(<span class="string"><span class="delimiter">&quot;</span><span class="content">Barney</span><span class="delimiter">&quot;</span></span>, [<span class="key">fetchSize</span>: <span class="integer">200</span>])</code></pre>
</div>
</div>
<div class="paragraph">
<p>Setting the fetch size to small values is discouraged as it will yield very poor performance.</p>
</div>
<div class="paragraph">
<p>In some cases you may want or have to disable paging entirely, for example when using order by and IN, in which case set the <code>fetchSize</code> to Integer.MAX_VALUE. Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">People.createCriteria().list {
    <span class="string"><span class="delimiter">'</span><span class="content">in</span><span class="delimiter">'</span></span> <span class="string"><span class="delimiter">&quot;</span><span class="content">lastName</span><span class="delimiter">&quot;</span></span>, [<span class="string"><span class="delimiter">&quot;</span><span class="content">Flintstone</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Rubble</span><span class="delimiter">&quot;</span></span>]
    order <span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>
    fetchSize <span class="predefined-type">Integer</span>.MAX_VALUE
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_allow_filtering">Allow filtering</h4>
<div class="paragraph">
<p>When you attempt a potentially expensive query Cassandra may throw an exception mentioning <a href="http://www.datastax.com/documentation/cql/3.1/cql/cql_reference/select_r.html?scroll=reference_ds_d35_v2q_xj__selAllFltr">ALLOW FILTERING</a>.
To run the query, you can use the <code>allowFiltering</code> argument which is passed onto Cassandra. Imposing a limit using the <code>max</code> parameter is recommended to reduce memory used.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> people = Person.findAllByFirstNameAndAgeLessThanEquals(<span class="string"><span class="delimiter">'</span><span class="content">Barney</span><span class="delimiter">'</span></span>, <span class="integer">35</span>, [<span class="key">allowFiltering</span>:<span class="predefined-constant">true</span>, <span class="key">max</span>:<span class="integer">5</span>])
<span class="keyword">def</span> person = Person.findOrSaveWhere(<span class="key">firstName</span>: <span class="string"><span class="delimiter">'</span><span class="content">Rubble</span><span class="delimiter">'</span></span>, <span class="key">age</span>: <span class="integer">35</span>, [<span class="key">allowFiltering</span>:<span class="predefined-constant">true</span>, <span class="key">flush</span>:<span class="predefined-constant">true</span>])
<span class="keyword">def</span> criteria = Person.createCriteria()
people = criteria.list (<span class="key">allowFiltering</span>:<span class="predefined-constant">true</span>, <span class="key">max</span>:<span class="integer">5</span>) {
            and {
                eq(<span class="string"><span class="delimiter">'</span><span class="content">firstName</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">Fred</span><span class="delimiter">'</span></span>)
                eq(<span class="string"><span class="delimiter">'</span><span class="content">age</span><span class="delimiter">'</span></span>, <span class="integer">40</span>)
            }
         }
people = criteria.list {
            projections {
                eq(<span class="string"><span class="delimiter">'</span><span class="content">firstName</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">Bob</span><span class="delimiter">'</span></span>)
                between(<span class="string"><span class="delimiter">&quot;</span><span class="content">age</span><span class="delimiter">&quot;</span></span>, <span class="integer">40</span>, <span class="integer">43</span>)
            }
            allowFiltering <span class="predefined-constant">true</span>
            max <span class="integer">5</span>
         }</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="lowLevelApi">Cassandra Low-level API</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A lower level API is provided by the plugin that is based on the <a href="http://projects.spring.io/spring-data-cassandra/">Spring Data Cassandra</a> project.</p>
</div>
<div class="paragraph">
<p>Spring Data Cassandra provides a <a href="http://docs.spring.io/spring-data/cassandra/docs/1.0.4.RELEASE/api/org/springframework/data/cassandra/core/CassandraTemplate.html">CassandraTemplate</a> with methods to execute statements using the regular <a href="http://www.datastax.com/documentation/developer/java-driver/2.0/common/drivers/introduction/introArchOverview_c.html">Cassandra Java Driver</a></p>
</div>
<div class="paragraph">
<p>To get hold of the <code>cassandraTemplate</code> instance inside a controller or service simply define a <code>cassandraTemplate</code> property. An example can be seen below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> cassandraTemplate

<span class="keyword">def</span> myAction = {
        <span class="keyword">def</span> people = <span class="type">[]</span>
        people &lt;&lt; <span class="keyword">new</span> Person(<span class="key">firstName</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Fred</span><span class="delimiter">&quot;</span></span>, <span class="key">lastName</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Flintstone</span><span class="delimiter">&quot;</span></span>)
        people &lt;&lt; <span class="keyword">new</span> Person(<span class="key">firstName</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Barney</span><span class="delimiter">&quot;</span></span>, <span class="key">lastName</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Rubble</span><span class="delimiter">&quot;</span></span>)
        cassandraTemplate.insert(people)
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also create a CQL or Java Driver statement and execute it using cassandraTemplate</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">Select personSelect = QueryBuilder.select().all().from(<span class="string"><span class="delimiter">&quot;</span><span class="content">person</span><span class="delimiter">&quot;</span></span>)
<span class="predefined-type">List</span> personList = cassandraTemplate.select(personSelect, Person.class)

<span class="predefined-type">String</span> personCQL = <span class="string"><span class="delimiter">&quot;</span><span class="content">SELECT firstName FROM person</span><span class="delimiter">&quot;</span></span>
<span class="predefined-type">List</span> personList = cassandraTemplate.select(personCQL, Person.class)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="reference">Reference</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="ref-beans">Beans</h3>
<div class="sect3">
<h4 id="ref-beans-cassandraTemplate">cassandraTemplate</h4>
<div class="sect4">
<h5 id="_cassandratemplate">CassandraTemplate</h5>

</div>
<div class="sect4">
<h5 id="_purpose">Purpose</h5>
<div class="paragraph">
<p>A Spring bean that provides access to the lower level CassandraTemplate API</p>
</div>
</div>
<div class="sect4">
<h5 id="_examples">Examples</h5>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> cassandraTemplate

<span class="keyword">def</span> myAction = {
    <span class="keyword">def</span> person = cassandraTemplate.selectOneById(Person.class, uuid)
    person.age = <span class="integer">30</span>
    cassandraTemplate.update(person)
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_description">Description</h5>
<div class="paragraph">
<p>See the <a href="http://docs.spring.io/spring-data/cassandra/docs/1.0.4.RELEASE/api/org/springframework/data/cassandra/core/CassandraTemplate.html">CassandraTemplate</a> docs, the <a href="http://www.datastax.com/documentation/developer/java-driver/2.0/common/drivers/introduction/introArchOverview_c.html">Cassandra Java Driver</a> docs, and the <a href="http://www.datastax.com/drivers/java/2.0/index.html">Cassandra Java Driver API</a> for API usage info.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ref-domain-classes">Domain Classes</h3>
<div class="sect3">
<h4 id="ref-domain-classes-appendTo">appendTo</h4>
<div class="sect4">
<h5 id="_appendto">appendTo*</h5>

</div>
<div class="sect4">
<h5 id="_purpose_2">Purpose</h5>
<div class="paragraph">
<p>Adds an element to an existing instance&#8217;s embedded set, list or map, where the actual collection or map added to is indicated by the property used as the suffix to the method.</p>
</div>
</div>
<div class="sect4">
<h5 id="_examples_2">Examples</h5>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Person</span> {
    <span class="predefined-type">List</span>&lt;<span class="predefined-type">Integer</span>&gt; scores
    <span class="predefined-type">Set</span>&lt;<span class="predefined-type">String</span>&gt; friends
    <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; pets
}

<span class="keyword">def</span> person = Person.get(uuid)
person.appendToScores(<span class="integer">5</span>)
Person.appendToFriends(person.id, <span class="string"><span class="delimiter">'</span><span class="content">Barney</span><span class="delimiter">'</span></span>, [<span class="key">flush</span>:<span class="predefined-constant">true</span>])</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_description_2">Description</h5>
<div class="paragraph">
<p>The appendTo* method is a dynamic method that adds an element to an embedded set, list or map. In the case of a list it adds the element to the end of the list.
The method exists as a static and instance method.
The static method simply adds the element to the datastore, the instance method adds the element to the in-memory instance and the datastore.</p>
</div>
<div class="paragraph">
<p>Argument:
* id - the id or primary key map of the instance. Only required if using the static method.
* element - the element to append
* flush (optional) - When set to true flushes the persistence context, updating the datastore immediately</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="ref-domain-classes-deleteAtFrom">deleteAtFrom</h4>
<div class="sect4">
<h5 id="_deleteatfrom">deleteAtFrom*</h5>

</div>
<div class="sect4">
<h5 id="_purpose_3">Purpose</h5>
<div class="paragraph">
<p>Removes an element at a specified index from an existing instance&#8217;s embedded list, where the actual list removed from is indicated by the property used as the suffix to the method.</p>
</div>
</div>
<div class="sect4">
<h5 id="_examples_3">Examples</h5>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Person</span> {
    <span class="predefined-type">List</span>&lt;<span class="predefined-type">Integer</span>&gt; scores
    <span class="predefined-type">Set</span>&lt;<span class="predefined-type">String</span>&gt; friends
    <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; pets
}

<span class="keyword">def</span> person = Person.get(uuid)
person.deleteAtFromScores(<span class="integer">1</span>)
Person.deleteAtFromScores([<span class="key">id</span>: person.id], <span class="integer">2</span>, [<span class="key">flush</span>:<span class="predefined-constant">true</span>])</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_description_3">Description</h5>
<div class="paragraph">
<p>The deleteAtFrom* method is a dynamic method that removes an element at the specified position in an embedded list.
The method exists as a static and instance method.
The static method simply removes the element in the datastore, the instance method removes the element in the in-memory instance and the datastore.</p>
</div>
<div class="paragraph">
<p>Argument:
* id - the id or primary key map of the instance. Only required if using the static method.
* index - the index of the element to remove
* flush (optional) - When set to true flushes the persistence context, updating the datastore immediately</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="ref-domain-classes-deleteFrom">deleteFrom</h4>
<div class="sect4">
<h5 id="_deletefrom">deleteFrom*</h5>

</div>
<div class="sect4">
<h5 id="_purpose_4">Purpose</h5>
<div class="paragraph">
<p>Removes an element from an existing instance&#8217;s embedded set, list or map, where the actual collection or map removed from is indicated by the property used as the suffix to the method.</p>
</div>
</div>
<div class="sect4">
<h5 id="_examples_4">Examples</h5>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Person</span> {
    <span class="predefined-type">List</span>&lt;<span class="predefined-type">Integer</span>&gt; scores
    <span class="predefined-type">Set</span>&lt;<span class="predefined-type">String</span>&gt; friends
    <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; pets
}

<span class="keyword">def</span> person = Person.get(uuid)
person.deleteFromScores(<span class="integer">5</span>)
Person.deleteFromFriends(person.id, <span class="string"><span class="delimiter">'</span><span class="content">Barney</span><span class="delimiter">'</span></span>, [<span class="key">flush</span>:<span class="predefined-constant">true</span>])
Person.deleteFromPets(person.id, <span class="string"><span class="delimiter">'</span><span class="content">eddie</span><span class="delimiter">'</span></span>, [<span class="key">flush</span>:<span class="predefined-constant">true</span>])</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_description_4">Description</h5>
<div class="paragraph">
<p>The deleteFrom* method is a dynamic method that removes an element from an embedded set, list or map. In the case of a map it removes the entry keyed by the specified element.
The method exists as a static and instance method.
The static method simply removes the element from the datastore, the instance method removes the element from the in-memory instance and the datastore.</p>
</div>
<div class="paragraph">
<p>Argument:
* id - the id or primary key map of the instance. Only required if using the static method.
* element - the element to remove, or the key of the entry to remove from a map
* flush (optional) - When set to true flushes the persistence context, updating the datastore immediately</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="ref-domain-classes-prependTo">prependTo</h4>
<div class="sect4">
<h5 id="_prependto">prependTo*</h5>

</div>
<div class="sect4">
<h5 id="_purpose_5">Purpose</h5>
<div class="paragraph">
<p>Prepends an element to an existing instance&#8217;s embedded list, where the actual list prepended to is indicated by the property used as the suffix to the method.</p>
</div>
</div>
<div class="sect4">
<h5 id="_examples_5">Examples</h5>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Person</span> {
    <span class="predefined-type">List</span>&lt;<span class="predefined-type">Integer</span>&gt; scores
    <span class="predefined-type">Set</span>&lt;<span class="predefined-type">String</span>&gt; friends
    <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; pets
}

<span class="keyword">def</span> person = Person.get(uuid)
person.prependToScores(<span class="integer">5</span>)
Person.prependToScores(<span class="integer">5</span>(person.id, <span class="integer">6</span>, [<span class="key">flush</span>:<span class="predefined-constant">true</span>])</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_description_5">Description</h5>
<div class="paragraph">
<p>The prependTo* method is a dynamic method that adds an element to the start of an embedded list.
The method exists as a static and instance method.
The static method simply adds the element to the datastore, the instance method adds the element to the in-memory instance and the datastore.</p>
</div>
<div class="paragraph">
<p>Argument:
* id - the id or primary key map of the instance. Only required if using the static method.
* element - the element to prepend
* flush (optional) - When set to true flushes the persistence context, updating the datastore immediately</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="ref-domain-classes-replaceAtIn">replaceAtIn</h4>
<div class="sect4">
<h5 id="_replaceatin">replaceAtIn*</h5>

</div>
<div class="sect4">
<h5 id="_purpose_6">Purpose</h5>
<div class="paragraph">
<p>Replaces an element at a specified index in an existing instance&#8217;s embedded list, where the actual list used is indicated by the property used as the suffix to the method.</p>
</div>
</div>
<div class="sect4">
<h5 id="_examples_6">Examples</h5>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Person</span> {
    <span class="predefined-type">List</span>&lt;<span class="predefined-type">Integer</span>&gt; scores
    <span class="predefined-type">Set</span>&lt;<span class="predefined-type">String</span>&gt; friends
    <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; pets
}

<span class="keyword">def</span> person = Person.get(uuid)
person.replaceAtInScores(<span class="integer">1</span>, <span class="integer">9</span>)
Person.replaceAtInScores([<span class="key">id</span>: person.id], <span class="integer">2</span>, <span class="integer">10</span>, [<span class="key">flush</span>:<span class="predefined-constant">true</span>])</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_description_6">Description</h5>
<div class="paragraph">
<p>The replaceAtIn* method is a dynamic method that replaces an element at the specified position in an embedded list.
The method exists as a static and instance method.
The static method simply replaces the element in the datastore, the instance method replaces the element in the in-memory instance and the datastore.</p>
</div>
<div class="paragraph">
<p>Argument:
* id - the id or primary key map of the instance. Only required if using the static method.
* index - the index of the element to replace
* element - element to be stored at the specified position
* flush (optional) - When set to true flushes the persistence context, updating the datastore immediately</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="ref-domain-classes-updateProperties">updateProperties</h4>
<div class="sect4">
<h5 id="_updateproperties">updateProperties</h5>

</div>
<div class="sect4">
<h5 id="_purpose_7">Purpose</h5>
<div class="paragraph">
<p>Static method that updates multiple properties on an existing instance in the datastore.</p>
</div>
</div>
<div class="sect4">
<h5 id="_examples_7">Examples</h5>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="predefined-type">Book</span>.updateProperties(uuid, [revenue : <span class="integer">300</span>, sold : <span class="integer">10</span>])
Person.updateProperties([<span class="key">firstName</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">Fred</span><span class="delimiter">&quot;</span></span>, <span class="key">lastName</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Flintstone</span><span class="delimiter">&quot;</span></span>], [age : <span class="integer">30</span>, <span class="key">email</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">fred.flintstone@gmail.com</span><span class="delimiter">&quot;</span></span>], [<span class="key">flush</span>:<span class="predefined-constant">true</span>])</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_description_7">Description</h5>
<div class="paragraph">
<p>Allows an update to multiple properties of an existing instance without having to get it from the datastore first. Will not validate the properties nor update the version column for optimistic locking.</p>
</div>
<div class="paragraph">
<p>Argument:
* id - the id or primary key map of the instance to update
* properties - a map of property name/value pairs to update
* flush (optional) - When set to true flushes the persistence context, updating the datastore immediately</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="ref-domain-classes-updateProperty">updateProperty</h4>
<div class="sect4">
<h5 id="_updateproperty">updateProperty</h5>

</div>
<div class="sect4">
<h5 id="_purpose_8">Purpose</h5>
<div class="paragraph">
<p>Static method that updates a single property on an existing instance in the datastore.</p>
</div>
</div>
<div class="sect4">
<h5 id="_examples_8">Examples</h5>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="predefined-type">Book</span>.updateProperty(uuid, <span class="string"><span class="delimiter">&quot;</span><span class="content">revenue</span><span class="delimiter">&quot;</span></span>, <span class="integer">300</span>)
Person.updateProperty([<span class="key">firstName</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">Fred</span><span class="delimiter">&quot;</span></span>, <span class="key">lastName</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Flintstone</span><span class="delimiter">&quot;</span></span>], <span class="string"><span class="delimiter">&quot;</span><span class="content">friends</span><span class="delimiter">&quot;</span></span>, [<span class="string"><span class="delimiter">&quot;</span><span class="content">Barney</span><span class="delimiter">&quot;</span></span>], [<span class="key">flush</span>:<span class="predefined-constant">true</span>])</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_description_8">Description</h5>
<div class="paragraph">
<p>Allows an update to a property of an existing instance without having to get it from the datastore first. Will not validate the property nor update the version column for optimistic locking.</p>
</div>
<div class="paragraph">
<p>Argument:
* id - the id or primary key map of the instance to update
* propertyName - the name of the property to update
* value - the new value of the property
* flush (optional) - When set to true flushes the persistence context, updating the datastore immediately</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="ref-domain-classes-updateSingleTypes">updateSingleTypes</h4>
<div class="sect4">
<h5 id="_updateproperty_2">updateProperty</h5>

</div>
<div class="sect4">
<h5 id="_purpose_9">Purpose</h5>
<div class="paragraph">
<p>Updates non collection, non map types only on an existing instance in the datastore. Useful when you don&#8217;t want to update the entire embedded collection or map on an instance when updating.</p>
</div>
</div>
<div class="sect4">
<h5 id="_examples_9">Examples</h5>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Person</span> {
    ..
    <span class="type">int</span> age
    <span class="predefined-type">List</span>&lt;<span class="predefined-type">Integer</span>&gt; scores
    <span class="predefined-type">Set</span>&lt;<span class="predefined-type">String</span>&gt; friends
    <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; pets
}

<span class="keyword">def</span> person = Person.get(uuid)
person.age = <span class="integer">31</span>
person.updateSimpleTypes(<span class="key">flush</span>:<span class="predefined-constant">true</span>)</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_description_9">Description</h5>
<div class="paragraph">
<p>The regular save() method would update all the elements in an embedded collection or map even if not required. This method allows an update of only the single types on an existing instance.</p>
</div>
<div class="paragraph">
<p>Argument:
* flush (optional) - When set to true flushes the persistence context, updating the datastore immediately</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2016-06-06 11:23:14 UTC
</div>
</div>
</body>
</html>